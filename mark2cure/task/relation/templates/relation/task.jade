extends base

- load widget_tweaks
- load humanize


block header
  - with headerMessage=task.name
    include includes/header-relation


block content

  .container-fluid
    #quest-guide.row
      .col-xs-12.col-md-12.col-md-offset-1.col-lg-12.col-lg-offset-1
        p#progress-bar

    .row
      .col-xs-12.col-md-10.col-md-offset-1
        #tree-insert

    .row
      .col-xs-10.col-xs-offset-1.col-sm-7.col-sm-offset-0.col-md-4.col-md-offset-4
        button.btn.btn-primary.btn-block#submit_button Submit

    .row
      .col-xs-12.col-md-10.col-md-offset-1
        div(id="doc_{{document.pk}}", data-doc_pk="{{document.pk}}", data-pmid="{{document.document_id}}").document
          .paragraphs
            - for section in document.section_set.all
              .paragraph-box.m-t-md
                p.section.paragraph #{section.text}

    .row(style="display:none;")
      form(id="task_relation_results", action='{% url "task-relation:results" document_pk=document.pk %}', method='POST')
        - csrf_token

    .row.m-t-md
      .col-sm-5.col-md-3.col-md-offset-1.hidden-xs-down
        div(role="group").btn-group-vertical
          a(data-toggle="modal", data-target="#relationshipInstructionsModal", style='background-color:#fff; color:#7F3CFF; border-color:#7F3CFF; border-width:3px').btn.btn-default
            | Relation Instructions  <i class="fa fa-external-link fa-lg"></i>

          a(data-toggle="modal", data-target="#diseaseDefinitionsModal", style='background-color: #d1f3ff;').btn.btn-default
            | Disease Concept  <i class="fa fa-external-link fa-lg"></i>

          a(data-toggle="modal", data-target="#geneDefinitionsModal", style='background-color:rgb(177, 255, 168);').btn.btn-default
            | Genes Concept  <i class="fa fa-external-link fa-lg"></i>

          a(data-toggle="modal", data-target="#treatmentDefinitionsModal", style='background-color:rgb(255, 209, 220);').btn.btn-default
            | Treatments Concept  <i class="fa fa-external-link fa-lg"></i>


block post-footer

  <script type="html/template" id="tree-template">
  <div id="tree" class="row text-center">

  <div class="col-xs-10 col-xs-offset-1 col-sm-4 col-sm-offset-0 col-md-3" id="c1">
  <div id="c1_remove_icon"><p></p></div>
  <div><h3><%= c1.text %></h3></div>
  <div id="c1_not_correct"><h2></h2></div>
  </div>

  <div class="col-xs-10 col-xs-offset-1 col-sm-4 col-sm-offset-0 col-md-6" style="padding-bottom:10px; padding-top:10px;">
  <h3 id="relation" class="disabled">Select a Relationship below...</h3>
  <ul class="list-group"></ul>
  </div>

  <div class="col-xs-10 col-xs-offset-1 col-sm-4 col-sm-offset-0 col-md-3" id="c2">
  <div id="c2_remove_icon"><p></p></div>
  <div><h3><%= c2.text %></h3></div>
  <div id="c2_not_correct"><h2></h2></div>
  </div>

  </script>

  script.
    var relation_task_settings = {
      'csrf_token': "{{csrf_token}}",
      'document_pk': "{{ document.pk }}"
    };
    $.getJSON('/static/js/tasks/relation-data.json', function(data) {
      relation_task_settings['data'] = data;
    });

  script(src="/static/js/libs/tree.js")
  script(src="/static/js/tasks/relation.js")
