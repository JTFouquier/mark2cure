extends base

- load widget_tweaks
- load comments


block content
  .container-fluid
    div(style="background: #f5f5f5;").row
      #chart(style="height:600px;").col-xs-10.col-xs-offset-1


block post-footer
  script.
    var s = new sigma({
      container: 'chart',

      settings: {

        defaultLabelColor: '#fff',
        defaultLabelSize: 14,
        defaultLabelBGColor: '#fff',
        defaultLabelHoverColor: '#000',
        labelThreshold: 6,

        defaultEdgeType: 'curve',

        minNodeSize: 0.5,
        maxNodeSize: 5,
        minEdgeSize: .1,
        maxEdgeSize: .1,

        search: true,

        maxRatio: 320,
      }
    });

    console.log('[SIGMA LOG] Loading...');
    sigma.parsers.json('/api/network/', s, function() {
      console.log('[SIGMA LOG] Loaded');
      s.refresh();
    });

    /*
    sigInst.bind('overnodes',function(event){
      var nodes = event.content;
      var neighbors = {};

      sigInst.iterEdges(function(e){
        if(nodes.indexOf(e.source)<0 && nodes.indexOf(e.target)<0){
          if(!e.attr['grey']){
            e.attr['true_color'] = e.color;
            e.color = greyColor;
            e.attr['grey'] = 1;
          }
        } else {
          e.color = e.attr['grey'] ? e.attr['true_color'] : e.color;
          e.attr['grey'] = 0;

          neighbors[e.source] = 1;
          neighbors[e.target] = 1;
        }
      }).iterNodes(function(n){
        if(!neighbors[n.id]){
          if(!n.attr['grey']){
            n.attr['true_color'] = n.color;
            n.color = greyColor;
            n.attr['grey'] = 1;
          }
        } else {
          n.color = n.attr['grey'] ? n.attr['true_color'] : n.color;
          n.attr['grey'] = 0;
        }
      }).draw(2,2,2);

    }).bind('outnodes',function(){
      sigInst.iterEdges(function(e){
        e.color = e.attr['grey'] ? e.attr['true_color'] : e.color;
        e.attr['grey'] = 0;
      }).iterNodes(function(n){
        n.color = n.attr['grey'] ? n.attr['true_color'] : n.color;
        n.attr['grey'] = 0;
      }).draw(2,2,2);
    });

    sigInst.draw();
    */
